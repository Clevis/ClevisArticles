(function(h,b){"object"===typeof exports?b(exports):"function"===typeof define&&define.amd?define(["exports"],b):b(h)})(this,function(h){function b(a){this._targetElement=a;this._wideAreaId=1;this._options={wideAreaAttr:"data-widearea",exitOnEsc:!0,defaultColorScheme:"light",closeIconLabel:"Close WideArea",changeThemeIconLabel:"Toggle Color Scheme",fullScreenIconLabel:"WideArea Mode"};q.call(this)}function q(){var a=this,c=this._targetElement.querySelectorAll("textarea["+this._options.wideAreaAttr+
"='enable']"),d=function(){r.call(a,this)};this._textareas=[];for(var f=c.length-1;0<=f;f--){var e=c[f],k=document.createElement("div"),g=document.createElement("div"),b=document.createElement("a");k.className="widearea-wrapper";g.className="widearea-icons";b.className="widearea-icon fullscreen";b.title=this._options.fullScreenIconLabel;b.href="javascript:void(0);";b.draggable=!1;b.onclick=d;e.className+=(e.className+" widearea").replace(/^\s+|\s+$/g,"");e.setAttribute("data-widearea-id",this._wideAreaId);
g.setAttribute("id","widearea-"+this._wideAreaId);++this._wideAreaId;n(e,g);g.appendChild(b);k.appendChild(g);document.body.appendChild(k);this._textareas.push(e)}this._timer=setInterval(function(){for(var c=a._textareas.length-1;0<=c;c--){var d=a._textareas[c],f=document.getElementById("widearea-"+d.getAttribute("data-widearea-id")),e=l(f),b=l(d);e.left-b.width+21==b.left&&e.top==b.top||n(d,f,b)}},200)}function n(a,c,d){a=d||l(a);c.style.left=a.left+a.width-21+"px";c.style.top=a.top+"px"}function l(a){var c=
{};c.width=a.offsetWidth;c.height=a.offsetHeight;for(var d=0,f=0;a&&!isNaN(a.offsetLeft)&&!isNaN(a.offsetTop);)d+=a.offsetLeft,f+=a.offsetTop,a=a.offsetParent;c.top=f;c.left=d;return c}function r(a){var c=this;a=parseInt(a.parentNode.id.replace(/widearea\-/,""));a=document.querySelector("textarea[data-widearea-id='"+a+"']");var d=a.cloneNode();d.className=("widearea-fullscreen "+a.className).replace(/^\s+|\s+$/g,"");a.className=("widearea-fullscreened "+a.className).replace(/^\s+|\s+$/g,"");var f=
document.createElement("div");f.className="widearea-controlPanel";var e=document.createElement("a");e.href="javascript:void(0);";e.className="widearea-icon close";e.title=this._options.closeIconLabel;e.onclick=function(){p.call(c)};e.draggable=!1;var b=document.createElement("a");b.href="javascript:void(0);";b.className="widearea-icon changeTheme";b.title=this._options.changeThemeIconLabel;b.onclick=function(){s.call(c)};b.draggable=!1;f.appendChild(e);f.appendChild(b);e=document.createElement("div");
e.className="widearea-overlayLayer "+this._options.defaultColorScheme;e.appendChild(d);e.appendChild(f);document.body.appendChild(e);d.focus();d.value=a.value;this._onKeyDown=function(a){27===a.keyCode&&c._options.exitOnEsc&&p.call(c);9==a.keyCode&&(a.preventDefault(),a=d.selectionStart,d.value=d.value.substring(0,a)+"\t"+d.value.substring(d.selectionEnd),d.selectionEnd=a+1)};window.addEventListener?window.addEventListener("keydown",c._onKeyDown,!0):document.attachEvent&&document.attachEvent("onkeydown",
c._onKeyDown)}function s(){var a=document.querySelector(".widearea-overlayLayer");/dark/gi.test(a.className)?a.className=a.className.replace("dark","light"):a.className=a.className.replace("light","dark")}function p(){var a=document.querySelector("textarea.widearea-fullscreened"),c=document.querySelector(".widearea-overlayLayer"),d=c.querySelector("textarea");a.focus();a.value=d.value;a.className=a.className.replace(/widearea-fullscreened/gi,"").replace(/^\s+|\s+$/g,"");c.parentNode.removeChild(c);
window.removeEventListener?window.removeEventListener("keydown",this._onKeyDown,!0):document.detachEvent&&document.detachEvent("onkeydown",this._onKeyDown)}var m=function(a){if("string"===typeof a){if(a=document.querySelector(a))return new b(a);throw Error("There is no element with given selector.");}return new b(document.body)};m.version="0.2.0";m.fn=b.prototype={clone:function(){return new b(this)},setOption:function(a,c){this._options[a]=c;return this},setOptions:function(a){var c=this._options,
d={},b;for(b in c)d[b]=c[b];for(b in a)d[b]=a[b];this._options=d;return this}};return h.wideArea=m});
